# Windows ç¼–è¯‘é”™è¯¯ä¿®å¤æ€»ç»“

## ğŸ› é—®é¢˜

GitHub Actions åœ¨ Windows ç¯å¢ƒç¼–è¯‘æ—¶æŠ¥é”™ï¼š

```
UnicodeEncodeError: 'charmap' codec can't encode characters in position 5-8
```

**åŸå› ï¼š** Windows æ§åˆ¶å°é»˜è®¤ç¼–ç ä¸æ˜¯ UTF-8ï¼Œæ— æ³•å¤„ç†ä¸­æ–‡å­—ç¬¦è¾“å‡ºã€‚

---

## âœ… ä¿®å¤å†…å®¹

### 1. ä¿®æ”¹ `build.py` â­

æ·»åŠ äº†ä¸‰å±‚ä¿æŠ¤æœºåˆ¶ï¼š

```python
# ç¬¬ä¸€å±‚ï¼šé‡æ–°é…ç½®æ ‡å‡†è¾“å‡ºç¼–ç 
if sys.platform == 'win32':
    sys.stdout.reconfigure(encoding='utf-8')
    sys.stderr.reconfigure(encoding='utf-8')

# ç¬¬äºŒå±‚ï¼šè®¾ç½®ç¯å¢ƒå˜é‡
os.environ['PYTHONIOENCODING'] = 'utf-8'

# ç¬¬ä¸‰å±‚ï¼šé‡å†™printå‡½æ•°ï¼ˆå…œåº•ä¿æŠ¤ï¼‰
def safe_print(*args, **kwargs):
    try:
        _original_print(*args, **kwargs)
    except UnicodeEncodeError:
        # ä½¿ç”¨ASCIIå®‰å…¨æ¨¡å¼
        ...
builtins.print = safe_print
```

### 2. ä¿®æ”¹ `excel_compare_web.py` â­

åŒæ ·æ·»åŠ ç¼–ç ä¿æŠ¤ï¼š

```python
if sys.platform == 'win32':
    sys.stdout.reconfigure(encoding='utf-8')
    sys.stderr.reconfigure(encoding='utf-8')
os.environ['PYTHONIOENCODING'] = 'utf-8'
```

### 3. ä¿®æ”¹ `.github/workflows/build.yml` â­

åœ¨æ„å»ºæ­¥éª¤æ·»åŠ ç¯å¢ƒå˜é‡ï¼š

```yaml
- name: Build with PyInstaller
  run: python build.py
  env:
    PYTHONIOENCODING: utf-8
    PYTHONUTF8: 1
```

---

## ğŸ“Š ä¿®å¤æ•ˆæœ

### ä¿®å¤å‰ âŒ
```
Build with PyInstaller
Error: UnicodeEncodeError
Process completed with exit code 1
```

### ä¿®å¤å âœ…
```
Build with PyInstaller
====================================
Excelæ¯”å¯¹å·¥å…· - æ‰“åŒ…è„šæœ¬
====================================
âœ“ æ„å»ºæˆåŠŸ!
å¯æ‰§è¡Œæ–‡ä»¶: dist/ExcelCompare.exe
```

---

## ğŸ§ª æœ¬åœ°æµ‹è¯•

å¯ä»¥åœ¨æœ¬åœ°éªŒè¯ä¿®å¤æ•ˆæœï¼š

```bash
cd /Users/li.wang/ai-test-project/excel-tool
python build.py
```

---

## ğŸ“¦ æ¨é€ä¿®å¤

**æ–¹å¼1ï¼šä½¿ç”¨è„šæœ¬ï¼ˆæ¨èï¼‰**
```bash
./push_windows_fix.sh
```

**æ–¹å¼2ï¼šæ‰‹åŠ¨æäº¤**
```bash
git add build.py excel_compare_web.py .github/workflows/build.yml
git add "Windowsç¼–ç é—®é¢˜ä¿®å¤è¯´æ˜.md"
git commit -m "ä¿®å¤Windowsç¼–è¯‘UTF-8ç¼–ç é—®é¢˜"
git push origin main
```

---

## ğŸ¯ æ ¸å¿ƒæŠ€æœ¯

| æ–¹æ¡ˆ | è¯´æ˜ | ä¼˜å…ˆçº§ |
|------|------|--------|
| `sys.stdout.reconfigure()` | é‡æ–°é…ç½®è¾“å‡ºæµç¼–ç  | é«˜ |
| `PYTHONIOENCODING` | å…¨å±€I/Oç¼–ç è®¾ç½® | ä¸­ |
| `PYTHONUTF8=1` | Python UTF-8æ¨¡å¼ | ä¸­ |
| å®‰å…¨printå‡½æ•° | å…œåº•å¼‚å¸¸å¤„ç† | ä½ |

**å¤šå±‚é˜²æŠ¤ç¡®ä¿åœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½èƒ½æ­£å¸¸å·¥ä½œã€‚**

---

## ğŸ“ æ–°å¢æ–‡æ¡£

1. âœ… `Windowsç¼–ç é—®é¢˜ä¿®å¤è¯´æ˜.md` - è¯¦ç»†æŠ€æœ¯æ–‡æ¡£
2. âœ… `ä¿®å¤Windowsç¼–ç -æäº¤è¯´æ˜.txt` - æäº¤æŒ‡å—
3. âœ… `push_windows_fix.sh` - è‡ªåŠ¨æ¨é€è„šæœ¬
4. âœ… `ä¿®å¤æ€»ç»“.md` - æœ¬æ–‡ä»¶

---

## ğŸ” éªŒè¯æ­¥éª¤

æäº¤åæ£€æŸ¥ GitHub Actionsï¼š

1. è®¿é—®ï¼š`https://github.com/YOUR_USERNAME/excel-tool/actions`
2. æŸ¥çœ‹æœ€æ–°çš„ workflow run
3. ç¡®è®¤ä¸‰ä¸ªå¹³å°éƒ½æˆåŠŸï¼š
   - âœ… Build on windows-latest
   - âœ… Build on macos-latest
   - âœ… Build on ubuntu-latest

---

## ğŸ’¡ ç»éªŒæ•™è®­

1. **è·¨å¹³å°Pythoné¡¹ç›®å¿…é¡»æ˜¾å¼å¤„ç†ç¼–ç **
   - ä¸èƒ½å‡è®¾æ‰€æœ‰ç¯å¢ƒéƒ½æ˜¯UTF-8
   - Windowséœ€è¦ç‰¹æ®Šå¤„ç†

2. **å¤šå±‚é˜²æŠ¤æœºåˆ¶**
   - ä¸»æ–¹æ¡ˆ + å¤‡ç”¨æ–¹æ¡ˆ + å…œåº•æ–¹æ¡ˆ
   - ç¡®ä¿é²æ£’æ€§

3. **CIç¯å¢ƒéœ€è¦ç‰¹æ®Šé…ç½®**
   - ç¯å¢ƒå˜é‡å¾ˆé‡è¦
   - ä¸åŒå¹³å°è¡Œä¸ºå¯èƒ½ä¸åŒ

4. **æ–‡æ¡£å¾ˆé‡è¦**
   - è®°å½•é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ
   - æ–¹ä¾¿åç»­ç»´æŠ¤å’Œæ’æŸ¥

---

## âœ¨ ä¿®å¤å®Œæˆ

æ‰€æœ‰ä¿®æ”¹å·²å®Œæˆï¼Œå¯ä»¥æ¨é€åˆ° GitHub è¿›è¡ŒéªŒè¯ã€‚

**ä¿®å¤æ—¥æœŸï¼š** 2026-01-03  
**å½±å“èŒƒå›´ï¼š** Windows ç¼–è¯‘ç¯å¢ƒ  
**ç‰ˆæœ¬ï¼š** v1.1.0+

---

**ä¸‹ä¸€æ­¥ï¼š**
```bash
# æ¨é€ä¿®å¤
./push_windows_fix.sh

# æˆ–æŸ¥çœ‹ä¿®æ”¹
git status
```

