# è¡¨å¤´æ˜¾ç¤ºæ–‡ä»¶ååŠŸèƒ½ - æµ‹è¯•éªŒè¯

## ğŸ§ª å¿«é€Ÿæµ‹è¯•æ­¥éª¤

### 1. å¯åŠ¨ç¨‹åº
```bash
cd /Users/li.wang/ai-test-project/excel-tool
python3 excel_compare_web.py
```

æµè§ˆå™¨è®¿é—®ï¼š`http://localhost:9527`

### 2. å‡†å¤‡æµ‹è¯•æ–‡ä»¶

å¯ä»¥ä½¿ç”¨å·²æœ‰çš„æµ‹è¯•æ–‡ä»¶ï¼Œæˆ–é‡æ–°ç”Ÿæˆï¼š
```
ç‚¹å‡»"ç”Ÿæˆæµ‹è¯•æ–‡ä»¶"æŒ‰é’®
```

è¿™ä¼šç”Ÿæˆï¼š
- `test_base.xlsx` - åŸºå‡†æ–‡ä»¶
- `test_data_a.xlsx` - è¾“å…¥1æ–‡ä»¶
- `test_data_b.xlsx` - è¾“å…¥2æ–‡ä»¶

### 3. ä¸Šä¼ æ–‡ä»¶å¹¶æ¯”å¯¹

1. é€‰æ‹©å·¥ä½œç›®å½•
2. ä¸Šä¼ åŸºå‡†æ–‡ä»¶ï¼š`test_base.xlsx`
3. ä¸Šä¼ è¾“å…¥1ï¼š`test_data_a.xlsx`
4. ä¸Šä¼ è¾“å…¥2ï¼š`test_data_b.xlsx`
5. ç‚¹å‡»"ğŸš€ å¼€å§‹å¯¹æ¯”"

### 4. éªŒè¯ç»“æœ

ç‚¹å‡»"æ‰“å¼€ç»“æœ"æŒ‰é’®ï¼Œæ‰“å¼€ `compare_result.xlsx`

**æ£€æŸ¥é¡¹ï¼š**

#### âœ… è¡¨å¤´ç¬¬2åˆ—
- **æœŸæœ›**ï¼šæ˜¾ç¤º `test_data_a`ï¼ˆä¸å« .xlsxï¼‰
- **ä¸åº”è¯¥**ï¼šæ˜¾ç¤º `A`

#### âœ… è¡¨å¤´ç¬¬3åˆ—
- **æœŸæœ›**ï¼šæ˜¾ç¤º `test_data_b`ï¼ˆä¸å« .xlsxï¼‰
- **ä¸åº”è¯¥**ï¼šæ˜¾ç¤º `B`

#### âœ… è¡¨å¤´ç¬¬4åˆ—ï¼ˆå·®é¢åˆ—ï¼‰
- **æœŸæœ›**ï¼šæ˜¾ç¤º `å·®é¢(test_data_a-test_data_b)`
- **ä¸åº”è¯¥**ï¼šæ˜¾ç¤º `å·®é¢(A-B)`

#### âœ… å›¾ä¾‹è¯´æ˜ï¼ˆå³ä¸Šè§’ G1ï¼‰
- **æœŸæœ›**ï¼šæ˜¾ç¤º `test_data_a=test_data_b æˆ– |å·®å¼‚%|<1.0%`
- **ä¸åº”è¯¥**ï¼šæ˜¾ç¤º `A=B æˆ– |å·®å¼‚%|<1.0%`

---

## ğŸ¯ é«˜çº§æµ‹è¯•åœºæ™¯

### æµ‹è¯•1ï¼šä¸­æ–‡æ–‡ä»¶å

**æ­¥éª¤ï¼š**
1. å°† `test_data_a.xlsx` é‡å‘½åä¸º `2024å¹´æ•°æ®.xlsx`
2. å°† `test_data_b.xlsx` é‡å‘½åä¸º `2023å¹´æ•°æ®.xlsx`
3. ä¸Šä¼ å¹¶æ¯”å¯¹

**é¢„æœŸç»“æœï¼š**
```
| æŒ‡æ ‡åç§° | 2024å¹´æ•°æ® | 2023å¹´æ•°æ® | å·®é¢(2024å¹´æ•°æ®-2023å¹´æ•°æ®) | å·®å¼‚% |
```

**å›¾ä¾‹ï¼š**
```
2024å¹´æ•°æ®=2023å¹´æ•°æ® æˆ– |å·®å¼‚%|<1.0%  [ç»¿è‰²]
```

---

### æµ‹è¯•2ï¼šå¸¦ä¸‹åˆ’çº¿å’Œæ—¥æœŸçš„æ–‡ä»¶å

**æ­¥éª¤ï¼š**
1. é‡å‘½åä¸º `è´¢åŠ¡æŠ¥è¡¨_Q1_2024.xlsx`
2. é‡å‘½åä¸º `è´¢åŠ¡æŠ¥è¡¨_Q2_2024.xlsx`
3. ä¸Šä¼ å¹¶æ¯”å¯¹

**é¢„æœŸç»“æœï¼š**
```
| æŒ‡æ ‡åç§° | è´¢åŠ¡æŠ¥è¡¨_Q1_2024 | è´¢åŠ¡æŠ¥è¡¨_Q2_2024 | å·®é¢(è´¢åŠ¡æŠ¥è¡¨_Q1_2024-è´¢åŠ¡æŠ¥è¡¨_Q2_2024) | å·®å¼‚% |
```

---

### æµ‹è¯•3ï¼šå¸¦ç©ºæ ¼çš„æ–‡ä»¶å

**æ­¥éª¤ï¼š**
1. é‡å‘½åä¸º `sales data 2024.xlsx`
2. é‡å‘½åä¸º `sales data 2023.xlsx`
3. ä¸Šä¼ å¹¶æ¯”å¯¹

**é¢„æœŸç»“æœï¼š**
```
| æŒ‡æ ‡åç§° | sales data 2024 | sales data 2023 | å·®é¢(sales data 2024-sales data 2023) | å·®å¼‚% |
```

---

### æµ‹è¯•4ï¼šæ··åˆå­—ç¬¦æ–‡ä»¶å

**æ­¥éª¤ï¼š**
1. é‡å‘½åä¸º `æ•°æ®_2024-Q1(åˆç¨¿).xlsx`
2. é‡å‘½åä¸º `æ•°æ®_2024-Q2(åˆç¨¿).xlsx`
3. ä¸Šä¼ å¹¶æ¯”å¯¹

**é¢„æœŸç»“æœï¼š**
```
| æŒ‡æ ‡åç§° | æ•°æ®_2024-Q1(åˆç¨¿) | æ•°æ®_2024-Q2(åˆç¨¿) | å·®é¢(æ•°æ®_2024-Q1(åˆç¨¿)-æ•°æ®_2024-Q2(åˆç¨¿)) | å·®å¼‚% |
```

---

### æµ‹è¯•5ï¼š.xls æ ¼å¼æ–‡ä»¶

å¦‚æœä½¿ç”¨ `.xls` æ ¼å¼æ–‡ä»¶ï¼š

**æ­¥éª¤ï¼š**
1. ä½¿ç”¨ `report_v1.xls`
2. ä½¿ç”¨ `report_v2.xls`

**é¢„æœŸç»“æœï¼š**
```
| æŒ‡æ ‡åç§° | report_v1 | report_v2 | å·®é¢(report_v1-report_v2) | å·®å¼‚% |
```

æ‰©å±•å `.xls` ä¹Ÿåº”è¯¥è¢«æ­£ç¡®ç§»é™¤ã€‚

---

## ğŸ“‹ éªŒè¯æ¸…å•

å®Œæ•´çš„æµ‹è¯•æ¸…å•ï¼š

- [ ] **åŸºæœ¬åŠŸèƒ½**
  - [ ] è¡¨å¤´ç¬¬2åˆ—æ˜¾ç¤ºæ–‡ä»¶1åç§°ï¼ˆæ— æ‰©å±•åï¼‰
  - [ ] è¡¨å¤´ç¬¬3åˆ—æ˜¾ç¤ºæ–‡ä»¶2åç§°ï¼ˆæ— æ‰©å±•åï¼‰
  - [ ] å·®é¢åˆ—æ˜¾ç¤ºæ­£ç¡®çš„æ–‡ä»¶åç»„åˆ
  - [ ] å›¾ä¾‹æ˜¾ç¤ºæ­£ç¡®çš„æ–‡ä»¶å

- [ ] **æ–‡ä»¶åç±»å‹**
  - [ ] è‹±æ–‡æ–‡ä»¶åæ­£å¸¸
  - [ ] ä¸­æ–‡æ–‡ä»¶åæ­£å¸¸
  - [ ] å¸¦ç©ºæ ¼æ–‡ä»¶åæ­£å¸¸
  - [ ] å¸¦ä¸‹åˆ’çº¿æ–‡ä»¶åæ­£å¸¸
  - [ ] å¸¦è¿å­—ç¬¦æ–‡ä»¶åæ­£å¸¸
  - [ ] å¸¦æ‹¬å·æ–‡ä»¶åæ­£å¸¸
  - [ ] æ··åˆå­—ç¬¦æ­£å¸¸

- [ ] **æ‰©å±•åå¤„ç†**
  - [ ] `.xlsx` æ‰©å±•åè¢«ç§»é™¤
  - [ ] `.xls` æ‰©å±•åè¢«ç§»é™¤

- [ ] **æ•°æ®æ­£ç¡®æ€§**
  - [ ] æ•°æ®å¯¹æ¯”ç»“æœæ­£ç¡®
  - [ ] é¢œè‰²æ ‡è®°æ­£ç¡®ï¼ˆç»¿è‰²/çº¢è‰²ï¼‰
  - [ ] å·®é¢è®¡ç®—æ­£ç¡®
  - [ ] ç™¾åˆ†æ¯”è®¡ç®—æ­£ç¡®

- [ ] **å¸ƒå±€å’Œæ˜¾ç¤º**
  - [ ] è¡¨å¤´å±…ä¸­å¯¹é½
  - [ ] è¡¨å¤´åŠ ç²—æ˜¾ç¤º
  - [ ] åˆ—å®½é€‚å½“
  - [ ] å›¾ä¾‹ä½ç½®æ­£ç¡®ï¼ˆå³ä¸Šè§’ï¼‰

---

## ğŸ› å¸¸è§é—®é¢˜æ’æŸ¥

### é—®é¢˜1ï¼šè¡¨å¤´ä»æ˜¾ç¤º"A"å’Œ"B"

**å¯èƒ½åŸå› ï¼š**
- ä»£ç æœªæ­£ç¡®ä¿å­˜
- ç¨‹åºæœªé‡å¯

**è§£å†³æ–¹æ³•ï¼š**
1. åœæ­¢å½“å‰è¿è¡Œçš„ç¨‹åºï¼ˆCtrl+Cï¼‰
2. é‡æ–°å¯åŠ¨ï¼š`python3 excel_compare_web.py`
3. é‡æ–°æµ‹è¯•

---

### é—®é¢˜2ï¼šæ–‡ä»¶åæ˜¾ç¤ºä¸ºå®Œæ•´è·¯å¾„

**å¯èƒ½åŸå› ï¼š**
- `os.path.basename()` æœªæ­£ç¡®æ‰§è¡Œ

**æ£€æŸ¥ï¼š**
æ‰“å¼€ `excel_compare_web.py`ï¼Œç¡®è®¤ç¬¬464-465è¡Œï¼š
```python
data_a_name = os.path.basename(data_a_file).replace('.xlsx', '').replace('.xls', '')
data_b_name = os.path.basename(data_b_file).replace('.xlsx', '').replace('.xls', '')
```

---

### é—®é¢˜3ï¼šæ–‡ä»¶ååŒ…å« `.xlsx` åç¼€

**å¯èƒ½åŸå› ï¼š**
- `.replace()` æœªæ‰§è¡Œ

**æ£€æŸ¥ï¼š**
ç¡®è®¤ä»£ç ä¸­æœ‰ï¼š
```python
.replace('.xlsx', '').replace('.xls', '')
```

---

### é—®é¢˜4ï¼šä¸­æ–‡æ–‡ä»¶åä¹±ç 

**å¯èƒ½åŸå› ï¼š**
- Windows ç¼–ç é—®é¢˜

**å·²ä¿®å¤ï¼š**
ä¹‹å‰å·²æ·»åŠ  UTF-8 ç¼–ç æ”¯æŒï¼Œåº”è¯¥ä¸ä¼šå‡ºç°æ­¤é—®é¢˜ã€‚å¦‚æœä»æœ‰é—®é¢˜ï¼Œæ£€æŸ¥ï¼š
```python
# æ–‡ä»¶å¼€å¤´åº”è¯¥æœ‰ï¼š
# -*- coding: utf-8 -*-
```

---

## ğŸ“¸ é¢„æœŸæ•ˆæœæˆªå›¾è¯´æ˜

### æµ‹è¯•æ–‡ä»¶
```
test_data_a.xlsx
test_data_b.xlsx
```

### é¢„æœŸçš„ Excel è¡¨å¤´
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æŒ‡æ ‡åç§°   â”‚ test_data_a â”‚ test_data_b â”‚ å·®é¢(test_data_a-test_data_b)â”‚ å·®å¼‚%  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ­£å¸¸_å®Œå…¨ç›¸åŒâ”‚ 1000000   â”‚ 1000000     â”‚ 0                            â”‚ 0.0%   â”‚
â”‚            â”‚             â”‚             â”‚                              â”‚        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                             
                                            å³ä¸Šè§’å›¾ä¾‹ï¼š
                                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
                                            â”‚test_data_a=test_data_b æˆ–  â”‚ ç»¿è‰² â”‚
                                            â”‚|å·®å¼‚%|<1.0%                â”‚      â”‚
                                            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¤
                                            â”‚å…¶ä»–æƒ…å†µ                    â”‚ çº¢è‰² â”‚
                                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜
```

---

## âœ… æµ‹è¯•é€šè¿‡æ ‡å‡†

æ‰€æœ‰ä»¥ä¸‹æ¡ä»¶éƒ½æ»¡è¶³æ‰ç®—æµ‹è¯•é€šè¿‡ï¼š

1. âœ… è¡¨å¤´ä¸æ˜¾ç¤º"A"ã€"B"ï¼Œè€Œæ˜¯æ˜¾ç¤ºå®é™…æ–‡ä»¶å
2. âœ… æ–‡ä»¶åä¸åŒ…å« `.xlsx` æˆ– `.xls` æ‰©å±•å
3. âœ… å·®é¢åˆ—æ­£ç¡®æ˜¾ç¤ºæ–‡ä»¶åç»„åˆ
4. âœ… å›¾ä¾‹æ­£ç¡®æ˜¾ç¤ºæ–‡ä»¶å
5. âœ… æ”¯æŒä¸­æ–‡ã€è‹±æ–‡ã€æ··åˆæ–‡ä»¶å
6. âœ… æ•°æ®å¯¹æ¯”ç»“æœæ­£ç¡®
7. âœ… é¢œè‰²æ ‡è®°æ­£ç¡®

---

## ğŸ“ æµ‹è¯•æŠ¥å‘Šæ¨¡æ¿

```
æµ‹è¯•æ—¥æœŸï¼š2026-01-03
æµ‹è¯•äººå‘˜ï¼š
æµ‹è¯•ç¯å¢ƒï¼šmacOS / Windows / Linux
æµè§ˆå™¨ï¼šChrome / Safari / Edge

æµ‹è¯•ç»“æœï¼š
[ ] é€šè¿‡
[ ] æœªé€šè¿‡

è¯¦ç»†è¯´æ˜ï¼š
1. è¡¨å¤´æ˜¾ç¤ºï¼š
   - ç¬¬2åˆ—ï¼š____________ï¼ˆæœŸæœ›ï¼šæ–‡ä»¶å1ï¼‰
   - ç¬¬3åˆ—ï¼š____________ï¼ˆæœŸæœ›ï¼šæ–‡ä»¶å2ï¼‰
   - ç¬¬4åˆ—ï¼š____________ï¼ˆæœŸæœ›ï¼šå·®é¢(æ–‡ä»¶å1-æ–‡ä»¶å2)ï¼‰

2. å›¾ä¾‹æ˜¾ç¤ºï¼š
   - G1å•å…ƒæ ¼ï¼š____________ï¼ˆæœŸæœ›ï¼šæ–‡ä»¶å1=æ–‡ä»¶å2 æˆ– |å·®å¼‚%|<1.0%ï¼‰

3. ä¸­æ–‡æ–‡ä»¶åæµ‹è¯•ï¼š
   - [ ] é€šè¿‡
   - [ ] æœªé€šè¿‡
   - è¯´æ˜ï¼š____________

4. æ•°æ®æ­£ç¡®æ€§ï¼š
   - [ ] é€šè¿‡
   - [ ] æœªé€šè¿‡
   - è¯´æ˜ï¼š____________

é—®é¢˜å’Œå»ºè®®ï¼š
____________
____________
```

---

**æµ‹è¯•å®Œæˆåï¼Œå¦‚æœ‰é—®é¢˜è¯·æŸ¥çœ‹ï¼š**
- `è¡¨å¤´æ˜¾ç¤ºæ–‡ä»¶å-åŠŸèƒ½è¯´æ˜.md` - è¯¦ç»†åŠŸèƒ½è¯´æ˜
- `æ›´æ–°è¯´æ˜-è¡¨å¤´æ–‡ä»¶å.txt` - å¿«é€Ÿå‚è€ƒ

---

**ç¥æµ‹è¯•é¡ºåˆ©ï¼** ğŸ‰

